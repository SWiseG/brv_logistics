{% load static %}

<!-- Top Bar -->
<div class="top-bar bg-dark text-white py-2 d-none d-md-block">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-md-6">
                <div class="top-bar-info d-flex align-items-center">
                    <span class="me-3">
                        <i class="fas fa-phone me-2"></i>{{ SITE_PHONE }}
                    </span>
                    <span class="me-3">
                        <i class="fas fa-envelope me-2"></i>{{ SITE_EMAIL }}
                    </span>
                    <a href="https://wa.me/{{ SITE_WHATSAPP }}" target="_blank" class="text-success text-decoration-none">
                        <i class="fab fa-whatsapp me-2"></i>WhatsApp
                    </a>
                </div>
            </div>
            <div class="col-md-6 text-end">
                <div class="top-bar-links">
                    {% if user.is_authenticated %}
                        <div class="dropdown d-inline-block">
                            <a href="#" class="text-white dropdown-toggle text-decoration-none" 
                               data-bs-toggle="dropdown" aria-expanded="false">
                                <i class="fas fa-user me-2"></i>Olá, {{ user.first_name|default:user.username }}!
                            </a>
                            <ul class="dropdown-menu dropdown-menu-end">
                                <li><a class="dropdown-item" href="{% url 'account:profile' %}">
                                    <i class="fas fa-user me-2"></i>Minha Conta
                                </a></li>
                                <li><a class="dropdown-item" href="{% url 'orders:my_orders' %}">
                                    <i class="fas fa-box me-2"></i>Meus Pedidos
                                </a></li>
                                <li><a class="dropdown-item" href="{% url 'wishlist:index' %}">
                                    <i class="fas fa-heart me-2"></i>Lista de Desejos
                                </a></li>
                                <li><hr class="dropdown-divider"></li>
                                <li><a class="dropdown-item" href="{% url 'account:logout' %}">
                                    <i class="fas fa-sign-out-alt me-2"></i>Sair
                                </a></li>
                            </ul>
                        </div>
                    {% else %}
                        <a href="{% url 'account:login' %}" class="text-white text-decoration-none me-3">
                            <i class="fas fa-sign-in-alt me-2"></i>Entrar
                        </a>
                        <a href="{% url 'account:register' %}" class="text-white text-decoration-none">
                            <i class="fas fa-user-plus me-2"></i>Cadastrar
                        </a>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Main Header -->
<div class="main-header bg-white py-3 shadow-sm sticky-top">
    <div class="container">
        <div class="row align-items-center">
            <!-- Cart and Actions -->
            <div class="col-lg-4 col-md-4 order-lg-3 order-2 col-6">
                <div class="header-actions d-flex justify-content-end align-items-center">
                    <!-- Wishlist -->
                    {% if user.is_authenticated %}
                        <a href="{% url 'wishlist:index' %}" class="header-action-btn btn btn-outline-secondary me-2 position-relative">
                            <i class="fas fa-heart"></i>
                            <span class="d-none d-sm-inline ms-2">Favoritos</span>
                            <span class="badge bg-danger position-absolute top-0 start-100 translate-middle rounded-pill" 
                                id="wishlistCount" style="font-size: 0.7em;">
                                {{ wishlist_count|default:0 }}
                            </span>
                        </a>
                    {% endif %}

                    <!-- Cart Dropdown -->
                    <div class="dropdown">
                        <button class="btn btn-primary position-relative dropdown-toggle" 
                                type="button" 
                                id="cartDropdown" 
                                data-bs-toggle="dropdown" 
                                aria-expanded="false">
                            <i class="fas fa-shopping-cart"></i>
                            <span class="d-none d-sm-inline ms-2">Carrinho</span>
                            <span class="badge bg-light text-dark position-absolute top-0 start-100 translate-middle rounded-pill" 
                                  id="cartCount" style="font-size: 0.7em;">
                                {{ cart_count|default:0 }}
                            </span>
                        </button>
                        
                        <div class="dropdown-menu dropdown-menu-end cart-dropdown p-0" style="width: 350px; max-width: 90vw;">
                            <div class="dropdown-header bg-light">
                                <h6 class="mb-0">Meu Carrinho</h6>
                            </div>
                            <div id="cartDropdownContent" class="cart-dropdown-content">
                                <!-- Conteúdo será carregado via AJAX -->
                                <div class="text-center p-3">
                                    <div class="spinner-border spinner-border-sm text-primary" role="status">
                                        <span class="visually-hidden">Carregando...</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Navigation Menu -->
<nav class="main-nav bg-primary d-none d-lg-block">
    <div class="container">
        <div class="row">
            <div class="col-12">
                <ul class="nav-menu d-flex list-unstyled mb-0 align-items-center">
                    <!-- Categories Dropdown -->
                    <li class="nav-item dropdown mega-dropdown">
                        <a href="#" class="nav-link text-white dropdown-toggle px-3 py-2" 
                           data-bs-toggle="dropdown" aria-expanded="false">
                            <i class="fas fa-th-large me-2"></i>Categorias
                        </a>
                        <div class="dropdown-menu mega-menu p-0">
                            <div class="container">
                                <div class="row g-0">
                                    {% for category in main_categories %}
                                    <div class="col-md-3 col-sm-6">
                                        <div class="p-3 border-end">
                                            <h6 class="dropdown-header">
                                                <a href="{{ category.get_absolute_url }}" class="text-decoration-none">
                                                    {{ category.name }}
                                                </a>
                                                <small class="text-muted">({{ category.product_count }})</small>
                                            </h6>
                                            {% for subcategory in category.children %}
                                            <a href="{{ subcategory.get_absolute_url }}" class="dropdown-item py-1">
                                                {{ subcategory.name }}
                                            </a>
                                            {% endfor %}
                                        </div>
                                    </div>
                                    {% endfor %}
                                </div>
                            </div>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</nav>